import { cn } from "@/lib/utils";
import { ComponentProps, useEffect, useRef } from "react";

interface InputProps extends ComponentProps<"input"> {
  onDeleteClick?: () => void;
}

const Input = ({ className, type, onDeleteClick, ...props }: InputProps) => {
  const deleteButtonVisible = !!props.value;

  const inputRef = useRef<HTMLInputElement>(null);

  useEffect(() => {
    if (inputRef.current) {
      inputRef.current.focus();
    }
  }, []);

  return (
    <div className="relative h-[36px] w-full">
      <input
        ref={inputRef}
        type={type}
        data-slot="input"
        className={cn(
          "placeholder:text-[rgba(0, 0, 0, 0.5)] w-full rounded-[10px] pl-[54px] py-[7px] outline-none",
          className,
        )}
        style={{ backgroundColor: "var(--gray)" }}
        {...props}
      />
      <SearchIcon className="absolute z-10 left-[13px] top-[10px] opacity-20" />
      {deleteButtonVisible && (
        <DeleteIcon
          className="absolute z-10 right-[10px] top-[10px] animate-in cursor-pointer"
          onClick={onDeleteClick}
        />
      )}
    </div>
  );
};

export { Input };

const SearchIcon = ({ className }: { className?: string }) => (
  <svg
    width="18"
    height="18"
    viewBox="0 0 18 18"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    className={className}
  >
    <path
      d="M0.890625 7.44629C0.890625 6.5332 1.06217 5.67822 1.40527 4.88135C1.74837 4.07894 2.22428 3.37337 2.83301 2.76465C3.44173 2.15592 4.14453 1.68001 4.94141 1.33691C5.74381 0.993815 6.60156 0.822266 7.51465 0.822266C8.42773 0.822266 9.28271 0.993815 10.0796 1.33691C10.882 1.68001 11.5876 2.15592 12.1963 2.76465C12.805 3.37337 13.2809 4.07894 13.624 4.88135C13.9671 5.67822 14.1387 6.5332 14.1387 7.44629C14.1387 8.20443 14.0169 8.92383 13.7734 9.60449C13.5355 10.2852 13.2035 10.9022 12.7773 11.4556L16.8364 15.5396C16.925 15.6281 16.9914 15.7305 17.0356 15.8467C17.0854 15.9629 17.1104 16.0874 17.1104 16.2202C17.1104 16.4028 17.0688 16.5688 16.9858 16.7183C16.9084 16.8677 16.7977 16.9839 16.6538 17.0669C16.5099 17.1554 16.3439 17.1997 16.1558 17.1997C16.0229 17.1997 15.8957 17.1748 15.7739 17.125C15.6577 17.0807 15.5498 17.0116 15.4502 16.9175L11.3662 12.8252C10.8239 13.2126 10.2262 13.5169 9.57324 13.7383C8.92025 13.9596 8.23405 14.0703 7.51465 14.0703C6.60156 14.0703 5.74381 13.8988 4.94141 13.5557C4.14453 13.2126 3.44173 12.7367 2.83301 12.1279C2.22428 11.5192 1.74837 10.8164 1.40527 10.0195C1.06217 9.21712 0.890625 8.35938 0.890625 7.44629ZM2.31006 7.44629C2.31006 8.16569 2.44287 8.84082 2.7085 9.47168C2.97966 10.097 3.35319 10.6476 3.8291 11.1235C4.31055 11.5994 4.86393 11.973 5.48926 12.2441C6.12012 12.5153 6.79525 12.6509 7.51465 12.6509C8.23405 12.6509 8.90641 12.5153 9.53174 12.2441C10.1626 11.973 10.716 11.5994 11.1919 11.1235C11.6678 10.6476 12.0413 10.097 12.3125 9.47168C12.5837 8.84082 12.7192 8.16569 12.7192 7.44629C12.7192 6.72689 12.5837 6.05452 12.3125 5.4292C12.0413 4.79834 11.6678 4.24495 11.1919 3.76904C10.716 3.2876 10.1626 2.91406 9.53174 2.64844C8.90641 2.37728 8.23405 2.2417 7.51465 2.2417C6.79525 2.2417 6.12012 2.37728 5.48926 2.64844C4.86393 2.91406 4.31055 3.2876 3.8291 3.76904C3.35319 4.24495 2.97966 4.79834 2.7085 5.4292C2.44287 6.05452 2.31006 6.72689 2.31006 7.44629Z"
      className="fill-foreground"
    />
  </svg>
);

const DeleteIcon = ({
  className,
  onClick,
}: {
  className?: string;
  onClick?: () => void;
}) => (
  <svg
    onClick={onClick}
    width="16"
    height="16"
    viewBox="0 0 16 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    className={className}
  >
    <g opacity="0.3" clip-path="url(#clip0_609_4597)">
      <path
        d="M8 16C6.90719 16 5.87712 15.7908 4.9098 15.3725C3.94771 14.9542 3.09804 14.3765 2.36078 13.6392C1.62353 12.902 1.04575 12.0523 0.627451 11.0902C0.20915 10.1229 0 9.09281 0 8C0 6.90719 0.20915 5.87974 0.627451 4.91765C1.04575 3.95033 1.62092 3.09804 2.35294 2.36078C3.0902 1.62353 3.93987 1.04575 4.90196 0.627451C5.86928 0.20915 6.89935 0 7.99216 0C9.08497 0 10.115 0.20915 11.0824 0.627451C12.0497 1.04575 12.902 1.62353 13.6392 2.36078C14.3765 3.09804 14.9542 3.95033 15.3725 4.91765C15.7908 5.87974 16 6.90719 16 8C16 9.09281 15.7908 10.1229 15.3725 11.0902C14.9542 12.0523 14.3765 12.902 13.6392 13.6392C12.902 14.3765 12.0497 14.9542 11.0824 15.3725C10.1203 15.7908 9.09281 16 8 16ZM5.36471 11.2941C5.55294 11.2941 5.71242 11.2314 5.84314 11.1059L8.00784 8.92549L10.1804 11.1059C10.3007 11.2314 10.4549 11.2941 10.6431 11.2941C10.8261 11.2941 10.9804 11.2314 11.1059 11.1059C11.2314 10.9752 11.2941 10.8209 11.2941 10.6431C11.2941 10.4497 11.2314 10.2954 11.1059 10.1804L8.92549 8.00784L11.1137 5.82745C11.2392 5.69673 11.302 5.54248 11.302 5.36471C11.302 5.18693 11.2392 5.03529 11.1137 4.9098C10.9882 4.78431 10.8366 4.72157 10.6588 4.72157C10.4863 4.72157 10.3373 4.78431 10.2118 4.9098L8.00784 7.09804L5.81961 4.91765C5.68889 4.79739 5.53725 4.73725 5.36471 4.73725C5.18693 4.73725 5.03529 4.8 4.9098 4.92549C4.78431 5.04575 4.72157 5.19739 4.72157 5.38039C4.72157 5.55294 4.78431 5.70458 4.9098 5.83529L7.0902 8.00784L4.9098 10.1882C4.78431 10.3137 4.72157 10.4654 4.72157 10.6431C4.72157 10.8209 4.78431 10.9752 4.9098 11.1059C5.03529 11.2314 5.18693 11.2941 5.36471 11.2941Z"
        className="fill-foreground"
      />
    </g>
    <defs>
      <clipPath id="clip0_609_4597">
        <rect width="16" height="16" className="fill-foreground" />
      </clipPath>
    </defs>
  </svg>
);
